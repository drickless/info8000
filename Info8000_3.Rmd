---
title: "Info8000 Assignment 3"
output: html_document
---
Description: Exploratory visualization of survey results

Questions:

Q1. Where are the respondents?
```{r}

#maps
library(maptools)
library(ggmap)
#read shp
pts <- readShapePoints("/Volumes/SANDISK/CoastSurvey/Geo/sgeoCh_wgs.shp")
#load basemap
mapImage <- get_map(location = c(lon = -81.09, lat = 32.08),
                    maptype = "terrain",
                    source = "google",
                    zoom = 10)
#convert shp to ggplot-friendly data frame
pts_fr <- data.frame(pts)
#plot points on map
ggmap(mapImage) +
  geom_point(data = pts_fr, aes(x = long, y = lat))
```


Q2. What is the distribution of demographic characteristics of the respondents?
    Income, Ethnicity, and Education variables visualized as bar graphs:
```{r}
library(tidyverse)
#sgeo <- read.csv("~/Desktop/sgeoTable.csv")
sgeo <- read.csv("~/Desktop/sgeoTable.csv")
a <- ggplot(data = sgeo)

a +
  geom_bar(mapping = aes(x = as.factor(Hincome))) +
    scale_x_discrete(breaks = c(1:7), 
                     labels = c("<25K","25-35K","35-50K","50-75K","75-100K","100-150K",">150K")) +
  labs(x = "Income Category")
a +
  geom_bar(mapping = aes(x = as.factor(Ethnicity))) +
    scale_x_discrete(breaks = c(1:8), 
                  labels = c("White","Hispanic","Black","Asian","Native American",
                                "MidEast/N.Africa","Pacific Islander","Other")) +
  labs(x = "Ethnicity")
a +
  geom_bar(mapping = aes(x = as.factor(Education))) +
  scale_x_discrete(breaks = c(1:7),
                   labels = c("Did not finish HS","HS/GED","Some college","Assoc","Bachelors","Some grad","Grad degree")) +
  labs(x = "Educational Attainment")
```

Q3. Do income, race, or ethnicity relate to how respondents perceive their ability to recover from storms?
    Less educated and lower income individuals, and members of minority communities are         theorized to be less able to recover from the impacts of severe storms. These graphs        break down respondents perceived ability to recover from storm damage based on these        variables. The results are represented as stacked bar graphs and as boxplots.

```{r}
  #by ethnicity
ggplot(sgeo, aes(PCNoRecov))+
  geom_bar(aes(fill = as.factor(Ethnicity))) +
  scale_fill_discrete(name = "Ethnicity", breaks = c(1:8),
                      labels = c("White","Hispanic","Black","Asian","Native American",
                                 "MidEast/N.Africa","Pacific Islander","Other")) +
  labs(x = "Ability to recover")
a +
  geom_boxplot(mapping = aes(x = as.factor(Ethnicity),y = PCNoRecov))+
  scale_x_discrete(breaks = c(1:8), 
                   labels = c("White","Hispanic","Black","Asian","Native American",
                              "MidEast/N.Africa","Pacific Islander","Other"))+
  labs(x = "Ethnicity",y = "Ability to recover")
  #by income
ggplot(sgeo, aes(PCNoRecov))+
  geom_bar(aes(fill = as.factor(Hincome))) +
  scale_fill_discrete(name = "Income Category", breaks = c(1:7),
                      labels = c("<25K","25-35K","35-50K","50-75K","75-100K","100-150K",">150K")) +
  labs(x = "Ability to recover")
a+ 
  geom_boxplot(mapping = aes(x = as.factor(Hincome), y = PCNoRecov))+
  scale_x_discrete(breaks = c(1:7), 
                   labels = c("<25K","25-35K","35-50K","50-75K","75-100K","100-150K",">150K")) +
  labs(x = "Income Category", y = "Ability to recover")

  #by education
ggplot(sgeo, aes(PCNoRecov))+
  geom_bar(aes(fill = as.factor(Education))) +
  scale_fill_discrete(name = "Educational attainment", breaks = c(1:7),
                      labels = c("Did not finish HS","HS/GED","Some college","Assoc","Bachelors","Some grad","Grad degree")) +
  labs(x = "Ability to recover")
a +
  geom_boxplot(mapping = aes(x = as.factor(Education),y = PCNoRecov)) +
  scale_x_discrete(breaks = c(1:7),
                   labels = c("Did not finish HS","HS/GED","Some college","Assoc","Bachelors","Some grad","Grad degree"))+
  labs(x = "Educational Attainment", y = "Ability to recover")
```


